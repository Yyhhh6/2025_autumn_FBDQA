train_data的列名： ['date', 'time', 'sym', 'n_close', 'amount_delta', 'n_midprice', 'n_bid1', 'n_bsize1', 'n_bid2', 'n_bsize2', 'n_bid3', 'n_bsize3', 'n_bid4', 'n_bsize4', 'n_bid5', 'n_bsize5', 'n_ask1', 'n_asize1', 'n_ask2', 'n_asize2', 'n_ask3', 'n_asize3', 'n_ask4', 'n_asize4', 'n_ask5', 'n_asize5', 'label_5', 'label_10', 'label_20', 'label_40', 'label_60', 'bid1', 'bid2', 'bid3', 'bid4', 'bid5', 'ask1', 'ask2', 'ask3', 'ask4', 'ask5', 'ask1_ma5', 'ask1_ma10', 'ask1_ma20', 'ask1_ma40', 'ask1_ma60', 'ask1_ma80', 'ask1_ma100', 'bid1_ma5', 'bid1_ma10', 'bid1_ma20', 'bid1_ma40', 'bid1_ma60', 'bid1_ma80', 'bid1_ma100', 'spread1', 'spread2', 'spread3', 'mid_price1', 'mid_price2', 'mid_price3', 'weighted_ab1', 'weighted_ab2', 'weighted_ab3', 'relative_spread1', 'relative_spread2', 'relative_spread3', 'bsize1', 'bsize2', 'bsize3', 'bsize4', 'bsize5', 'asize1', 'asize2', 'asize3', 'asize4', 'asize5', 'amount', 'ofi', 'ofi_ma5', 'ofi_ma20', 'ofi_ma50', 'ofi_trend_10', 'obi1', 'obi3', 'obi1_ma10', 'obi3_ma10', 'obi1_ma30', 'microprice', 'microprice_change', 'microprice_change_ma5', 'microprice_deviation', 'microprice_deviation_ma10', 'kyle_lambda', 'kyle_lambda_ma10', 'kyle_lambda_ma30', 'realized_vol_5', 'realized_vol_10', 'realized_vol_20', 'realized_vol_50', 'vol_change', 'vol_ratio', 'momentum_5', 'momentum_10', 'momentum_20', 'reversal_3', 'reversal_5', 'price_acceleration', 'effective_spread', 'effective_spread_ma10', 'effective_spread_ma30', 'spread_change', 'spread_volatility', 'volume_ratio_10', 'volume_ratio_30', 'volume_surge', 'volume_surge_ma10', 'short_rsi', 'price_momentum_3', 'price_momentum_5', 'bid_depth_3', 'ask_depth_3', 'depth_imbalance_3', 'bid_depth_change', 'ask_depth_change', 'bid_pressure', 'ask_pressure', 'bid_skew', 'ask_skew', 'price_mean_100', 'price_std_100', 'price_max_100', 'price_min_100', 'price_range_100', 'price_position', 'volume_mean_100', 'volume_std_100', 'spread_mean_100', 'spread_std_100', 'time_label']
训练集NaN特征: microprice_deviation_ma10    148
momentum_5                   420
momentum_10                  254
momentum_20                  161
reversal_3                   559
reversal_5                   420
effective_spread_ma10        148
effective_spread_ma30         14
spread_change                854
spread_volatility             51
price_momentum_3             559
price_momentum_5             420
dtype: int64
验证集NaN特征: microprice_deviation_ma10    647
momentum_5                   688
momentum_10                  662
momentum_20                  634
reversal_3                   734
reversal_5                   688
effective_spread_ma10        647
effective_spread_ma30        623
spread_change                814
spread_volatility            628
price_momentum_3             734
price_momentum_5             688
spread_mean_100              574
spread_std_100               576
dtype: int64
测试集NaN特征: spread_change    3
dtype: int64

========================================
Start training for N=5
effective samples -> train: 2020070 val: 795900 test: 66325
Training LightGBM (GPU)...
[LightGBM] [Info] This is the GPU trainer!!
[LightGBM] [Info] Total Bins 31622
[LightGBM] [Info] Number of data points in the train set: 2020070, number of used features: 126
[LightGBM] [Info] Using requested OpenCL platform 0 device 0
[LightGBM] [Info] Using GPU Device: NVIDIA A800 80GB PCIe, Vendor: NVIDIA Corporation
[LightGBM] [Info] Compiling OpenCL Kernel with 256 bins...
[LightGBM] [Info] GPU programs have been built
[LightGBM] [Info] Size of histogram bin entry: 8
[LightGBM] [Info] 126 dense feature groups (246.59 MB) transferred to GPU in 0.171667 secs. 0 sparse feature groups
[LightGBM] [Info] Start training from score -34.538776
[LightGBM] [Info] Start training from score -34.538776
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
Training until validation scores don't improve for 50 rounds
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
[LightGBM] [Warning] Stopped training because there are no more leaves that meet the split requirements
Early stopping, best iteration is:
[1]	valid's multi_logloss: 2.22045e-15

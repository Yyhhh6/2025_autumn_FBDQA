步骤1: 加载和划分数据...
train shape: (2426786, 31), val shape: (613693, 31)

步骤2: 执行数据分布分析...
可用的重要特征: ['n_close', 'amount_delta', 'n_midprice', 'n_bid1', 'n_ask1', 'n_bsize1', 'n_asize1', 'n_bid5', 'n_ask5']
============================================================
数据基本信息
============================================================

训练集基本信息:
            n_close  amount_delta    n_midprice        n_bid1        n_ask1      n_bsize1      n_asize1        n_bid5        n_ask5
count  2.426786e+06  2.426786e+06  2.426786e+06  2.426786e+06  2.426786e+06  2.426786e+06  2.426786e+06  2.426786e+06  2.426786e+06
mean   3.639054e-03  4.789571e+05  3.623192e-03  3.123271e-03  3.320680e-03  1.116080e-04  5.126315e-05 -1.509059e-03  7.793916e-03
std    2.442318e-02  1.717437e+06  2.439758e-02  2.416241e-02  2.256474e-02  8.770205e-04  1.952978e-04  2.480244e-02  2.289663e-02
min   -1.001495e-01  0.000000e+00 -1.001495e-01 -1.001495e-01 -1.001495e-01  0.000000e+00  0.000000e+00 -1.001495e-01 -9.865471e-02
25%   -9.900990e-03  6.547250e+03 -9.785203e-03 -1.044841e-02 -9.259259e-03  1.363093e-06  1.296601e-06 -1.559282e-02 -5.498822e-03
50%    2.084781e-03  8.371000e+04  1.901141e-03  1.218027e-03  2.352941e-03  6.536321e-06  6.302269e-06 -2.624672e-03  6.552007e-03
75%    1.463964e-02  3.990558e+05  1.456935e-02  1.401869e-02  1.456816e-02  3.229188e-05  2.998514e-05  1.004464e-02  1.956400e-02
max    1.005464e-01  8.991515e+08  1.005464e-01  1.005464e-01  1.005464e-01  2.775392e-02  5.535796e-03  9.922514e-02  1.002695e-01

验证集基本信息:
             n_close  amount_delta     n_midprice         n_bid1         n_ask1      n_bsize1       n_asize1         n_bid5         n_ask5
count  613693.000000  6.136930e+05  613693.000000  613693.000000  613693.000000  6.136930e+05  613693.000000  613693.000000  613693.000000
mean        0.003467  4.960987e+05       0.003468       0.002890       0.003167  1.443398e-04       0.000042      -0.001424       0.007461
std         0.024484  5.616337e+06       0.024462       0.024503       0.022710  1.296408e-03       0.000099       0.025129       0.023235
min        -0.089286  0.000000e+00      -0.088955      -0.089286      -0.088624  1.094077e-10       0.000000      -0.093915      -0.085979
25%        -0.009804  8.806000e+03      -0.009398      -0.010025      -0.009091  1.324041e-06       0.000001      -0.015487      -0.005666
50%         0.002792  9.683200e+04       0.002527       0.002227       0.002948  6.017470e-06       0.000006      -0.002038       0.006535
75%         0.015070  4.118690e+05       0.015186       0.014352       0.015094  2.926657e-05       0.000028       0.011151       0.020247
max         0.100277  3.440177e+09       0.100277       0.100277       0.100277  2.246036e-02       0.002902       0.099132       0.100277

训练集缺失值统计:
n_close         0
amount_delta    0
n_midprice      0
n_bid1          0
n_ask1          0
n_bsize1        0
n_asize1        0
n_bid5          0
n_ask5          0
dtype: int64

验证集缺失值统计:
n_close         0
amount_delta    0
n_midprice      0
n_bid1          0
n_ask1          0
n_bsize1        0
n_asize1        0
n_bid5          0
n_ask5          0
dtype: int64

============================================================
数据分布相似性分析
============================================================

特征分布相似性排序 (KS统计量越大，分布差异越大):
             ks_statistic ks_pvalue similar_distribution
amount_delta     0.023111       0.0                False
n_bid1           0.020785       0.0                False
n_midprice        0.02062       0.0                False
n_bid5           0.019798       0.0                False
n_ask1           0.019055       0.0                False
n_close          0.018332       0.0                False
n_asize1         0.015839       0.0                False
n_bsize1         0.014845       0.0                False
n_ask5           0.014786       0.0                False

步骤3: 绘制特征分布图...

步骤4: 绘制相关性对比图...

步骤5: 评估数据划分质量...

============================================================
数据划分质量评估
============================================================
总特征数量: 9
分布相似的特征数量: False
分布相似性比例: 0.00%
❌ 数据划分质量: 较差 - 训练集和验证集分布差异较大

分布差异最大的5个特征:
             ks_statistic ks_pvalue
amount_delta     0.023111       0.0
n_bid1           0.020785       0.0
n_midprice        0.02062       0.0
n_bid5           0.019798       0.0
n_ask1           0.019055       0.0
  amount_delta: KS统计量=0.0231, p值=0.0000
  n_bid1: KS统计量=0.0208, p值=0.0000
  n_midprice: KS统计量=0.0206, p值=0.0000
  n_bid5: KS统计量=0.0198, p值=0.0000
  n_ask1: KS统计量=0.0191, p值=0.0000

步骤6: 时间序列特性分析...
使用直方图范围: (np.float64(0.0), np.float64(0.0))

============================================================
数据分析完成！
============================================================
=================== label_5 ===================
0:	learn: 0.9729967	test: 0.9757869	best: 0.9757869 (0)	total: 153ms	remaining: 2m 32s
999:	learn: 0.6549860	test: 0.6946330	best: 0.6946330 (999)	total: 1m 18s	remaining: 0us

bestTest = 0.6946329964
bestIteration = 999

Precision: 0.533493496646499, Recall: 0.4071819131891868, F1_score: 0.4143724774887299
=================== label_10 ===================
0:	learn: 1.0231829	test: 1.0282846	best: 1.0282846 (0)	total: 109ms	remaining: 1m 49s
Stopped by overfitting detector  (100 iterations wait)

bestTest = 0.8525259182
bestIteration = 730

Shrink model to first 731 iterations.
Precision: 0.4960505774541267, Recall: 0.4351974205530081, F1_score: 0.4375219474452225
=================== label_20 ===================
0:	learn: 0.9980309	test: 1.0054104	best: 1.0054104 (0)	total: 86.5ms	remaining: 1m 26s
Stopped by overfitting detector  (100 iterations wait)

bestTest = 0.8202153205
bestIteration = 402

Shrink model to first 403 iterations.
Precision: 0.4856548299385674, Recall: 0.3717686867134083, F1_score: 0.3486477779937321
=================== label_40 ===================
0:	learn: 1.0528964	test: 1.0591481	best: 1.0591481 (0)	total: 89.9ms	remaining: 1m 29s
Stopped by overfitting detector  (100 iterations wait)

bestTest = 0.9725841838
bestIteration = 147

Shrink model to first 148 iterations.
Precision: 0.45081779483819573, Recall: 0.3900150309478058, F1_score: 0.3618346588515104
=================== label_60 ===================
0:	learn: 1.0717408	test: 1.0767292	best: 1.0767292 (0)	total: 93.3ms	remaining: 1m 33s
Stopped by overfitting detector  (100 iterations wait)

bestTest = 1.021815883
bestIteration = 123

Shrink model to first 124 iterations.
Precision: 0.4317350284558737, Recall: 0.405998116575564, F1_score: 0.38578188223711135
